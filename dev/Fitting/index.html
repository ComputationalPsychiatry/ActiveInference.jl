<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model Fitting · ActiveInference.jl</title><meta name="title" content="Model Fitting · ActiveInference.jl"/><meta property="og:title" content="Model Fitting · ActiveInference.jl"/><meta property="twitter:title" content="Model Fitting · ActiveInference.jl"/><meta name="description" content="Documentation for ActiveInference.jl."/><meta property="og:description" content="Documentation for ActiveInference.jl."/><meta property="twitter:description" content="Documentation for ActiveInference.jl."/><meta property="og:url" content="https://ilabcode.github.io/ActiveInference.jl/Fitting/"/><meta property="twitter:url" content="https://ilabcode.github.io/ActiveInference.jl/Fitting/"/><link rel="canonical" href="https://ilabcode.github.io/ActiveInference.jl/Fitting/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../Introduction/">ActiveInference.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">General Introduction</span><ul><li><a class="tocitem" href="../Introduction/">Introduction</a></li><li><a class="tocitem" href="../GenerativeModelCreation/">Creation of the Generative Model</a></li><li><a class="tocitem" href="../AgentCreation/">Creating the Agent</a></li><li><a class="tocitem" href="../Simulation/">Simulation</a></li><li class="is-active"><a class="tocitem" href>Model Fitting</a><ul class="internal"><li><a class="tocitem" href="#Model-Fitting-with-ActionModels.jl"><span>Model Fitting with ActionModels.jl</span></a></li></ul></li><li><a class="tocitem" href="../SimulationActionModels/">Simulation with ActionModels.jl</a></li></ul></li><li><span class="tocitem">Usage Examples</span><ul><li><span class="tocitem">T-Maze Simulation</span></li><li><span class="tocitem">T-Maze Model Fitting</span></li></ul></li><li><span class="tocitem">Theory</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Active Inference Theory</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><span class="tocitem">Perception</span></li><li><span class="tocitem">Action</span></li><li><span class="tocitem">Learning</span></li></ul></li><li><a class="tocitem" href="../GenerativeModelTheory/">POMDP Theory</a></li></ul></li><li><a class="tocitem" href="../WhyActiveInference/">Why Active Inference?</a></li><li><a class="tocitem" href="../">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">General Introduction</a></li><li class="is-active"><a href>Model Fitting</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model Fitting</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ilabcode/ActiveInference.jl/blob/master/docs/julia_files/Fitting.jl#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Model-Fitting"><a class="docs-heading-anchor" href="#Model-Fitting">Model Fitting</a><a id="Model-Fitting-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Fitting" title="Permalink"></a></h1><p>In many cases, we want to be able to draw conclusions about specific observed phenomena, such as behavioural differences between distinct populations. A conventional approach in this context is model fitting, which involves estimating the parameter values of a model (e.g., prior beliefs) that are most likely given the observed behavior of a participant. This approach is often used in fields such as computational psychiatry or mathematical psychology  to develop more precise models and theories of mental processes, to find mechanistic differences between clinical populations, or to investigate the relationship between computational constructs such as Bayesian beliefs and neuronal dynamics.</p><h2 id="Model-Fitting-with-ActionModels.jl"><a class="docs-heading-anchor" href="#Model-Fitting-with-ActionModels.jl">Model Fitting with ActionModels.jl</a><a id="Model-Fitting-with-ActionModels.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Fitting-with-ActionModels.jl" title="Permalink"></a></h2><p>Model fitting in &#39;<strong>ActiveInference</strong>&#39; is mediated through &#39;<strong>ActionModels</strong>&#39;, which is our sister package for implementing and fitting various behavioural models to data. The core of &#39;<strong>ActionModels</strong>&#39; is the action model function, which takes a single observation, runs the inference scheme (updating the agent&#39;s beliefs), and calculates the probability distribution over actions from which the agent samples its actions. <em>(Check out the <a href="https://ilabcode.github.io/ActionModels.jl/dev/markdowns/Introduction/">ActionModels documentation</a> for more details)</em></p><p>To demonstrate this, let&#39;s define a very simple generative model with a single state factor and two possible actions, and then initialize our active inference object:</p><pre><code class="language-julia hljs">
# Define the number of states, observations, and controls
n_states = [4]
n_observations = [4]
n_controls = [2]

# Define the policy length
policy_length = 1

# Use the create_matrix_templates function to create uniform A and B matrices.
A, B = create_matrix_templates(n_states, n_observations, n_controls, policy_length)

# Initialize an active inference object with the created matrices
aif = init_aif(A, B)</code></pre><p>We can now use the <code>action_pomdp!</code> function (which serves as our active inference &quot;action model&quot;) to calculate the probability distribution over actions for a single observation:</p><pre><code class="language-julia hljs">
# Define observation
observation = [1]

# Calculate action probabilities
action_distribution = action_pomdp!(aif, observation)</code></pre><h4 id="Agent-in-ActionModels.jl"><a class="docs-heading-anchor" href="#Agent-in-ActionModels.jl">Agent in ActionModels.jl</a><a id="Agent-in-ActionModels.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Agent-in-ActionModels.jl" title="Permalink"></a></h4><p>Another key component of &#39;<strong>ActionModels</strong>&#39; is an <code>Agent</code>, which wraps the action model and active inference object in a more abstract structure. The <code>Agent</code> is initialized using a <code>substruct</code> to include our active inference object, and the action model is our <code>action_pomdp!</code> function.</p><p>Let&#39;s first install &#39;<strong>ActionModels</strong>&#39; from the official Julia registry and import it:</p><pre><code class="language-julia hljs">
Pkg.add(&quot;ActionModels&quot;)
using ActionModels</code></pre><p>We can now create an <code>Agent</code> with the <code>action_pomdp!</code> function and the active inference object:</p><pre><code class="language-julia hljs"># Initialize agent with active inference object as substruct
agent = init_agent(
    action_pomdp!,  # The active inference action model
    substruct = aif # The active inference object
)</code></pre><p>We use an initialized <code>Agent</code> primarily for fitting; however, it can also be used with a set of convenience functions to run simulations, which are described in <a href="../SimulationActionModels/">Simulation with ActionModels</a>.</p><h4 id="Fitting-a-Single-Subject-Model"><a class="docs-heading-anchor" href="#Fitting-a-Single-Subject-Model">Fitting a Single Subject Model</a><a id="Fitting-a-Single-Subject-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting-a-Single-Subject-Model" title="Permalink"></a></h4><p>We have our <code>Agent</code> object defined as above. Next, we need to specify priors for the parameters we want to estimate.</p><p>For example, let&#39;s estimate the action precision parameter <code>α</code> and use a Gamma distribution as its prior.</p><pre><code class="language-julia hljs"># Import the Distributions package
using Distributions

# Define the prior distribution for the alpha parameters inside a dictionary
priors = Dict(&quot;alpha&quot; =&gt; Gamma(1, 1))</code></pre><p>We can now use the <code>create_model</code> function to instantiate a probabilistic model object with data. This function takes the <code>Agent</code> object, the priors, and a set of observations and actions as arguments.</p><p>First, let&#39;s define some observations and actions as vectors:</p><pre><code class="language-julia hljs"># Define observations and actions
observations = [1, 2, 3, 4]</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Simulation/">« Simulation</a><a class="docs-footer-nextpage" href="../SimulationActionModels/">Simulation with ActionModels.jl »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 4 December 2024 20:11">Wednesday 4 December 2024</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
